{
    "contents" : "setwd(\"/Users/ZhangXinhui/GitHub/EEB201-coursework\")\nsnpsDataFrame=read.table('hapmap_CEU_r23a_chr2_ld-1.txt',header=TRUE)\nphenoData = read.table('pheno.sim.2014-1.txt', header = TRUE)\n\n#1.a\nsnps=as.matrix(snpsDataFrame)\n\ncalc_freq=function(x){\n  return(sum(x,na.rm=TRUE)/(2.0*sum(!is.na(x))))\n}\n\ncalc_het=function(x){\n  return(sum(x==1,na.rm=TRUE)/(sum(!is.na(x))))\n}\n\nfreq=apply(snps,1,calc_freq)\nhet=apply(snps,1,calc_het)\n\nplot(freq,het,xlab=\"Frequency\",ylab=\"Heterozygosity\")  \n\np=seq(0,0.5,by=0.05)   \nlines(p,2*p*(1-p),type=\"l\",col=2, lwd = 4) \n\n\ncompute_chisquare=function(x){\n  freq=sum(x,na.rm=TRUE)/(2.0*sum(!is.na(x)))\n  cnt0=sum(x==0,na.rm=TRUE)\n  cnt1=sum(x==1,na.rm=TRUE)\n  cnt2=sum(x==2,na.rm=TRUE)\n  obscnts=c(cnt0,cnt1,cnt2)\n  #print(obscnts)\n  n=sum(obscnts)\n  expcnts=c((1-freq)^2,2*freq*(1-freq),freq^2)*n\n  chisq=sum((obscnts-expcnts)^2/expcnts)\n  return(chisq)\n}\n\n\n\ncompute_chisquare_2=function(x){\n  freq=sum(x,na.rm=TRUE)/(2.0*sum(!is.na(x)))\n  cnt0=sum(x==0,na.rm=TRUE)\n  cnt1=sum(x==1,na.rm=TRUE)\n  cnt2=sum(x==2,na.rm=TRUE)\n  obscnts=c(cnt0,cnt1,cnt2)\n  #print(obscnts)\n  n=sum(obscnts)\n  exp_probs=c((1-freq)^2,2*freq*(1-freq),freq^2) \n  chisq<-chisq.test(obscnts,p=exp_probs, correct = FALSE)$statistic\n  return(chisq)\n}\n\n\nchisqs=apply(snps,1,compute_chisquare)\nchisqs2=apply(snps,1,compute_chisquare_2)\n\ncor.test(chisqs,chisqs2)\n\nplot(chisqs,chisqs2)\n\npvals=pchisq(chisqs,1,lower.tail=FALSE)\n\n#1.b\nprop0.05 <- sum(pvals<0.05)/length(pvals)\nprop0.01 <- sum(pvals<0.01)/length(pvals)\nprop0.001 <- sum(pvals<0.001)/length(pvals)\n\n#1.c\nlength(pvals)\nnum_pval <- length(pvals)\n\n#1.d\nexp_pvals <- rep(NA, num_pval)\nfor(i in 1:num_pval){\n  exp_pvals[i] <- i/num_pval\n}\nexp_pvals\n\n#1.e\nsort(pvals, decreasing = FALSE)\nsort_pvals <- sort(pvals, decreasing = FALSE)\n\n#1.f\nlog_sort_pvals <- -log10(sort_pvals)\nlog_exp_pvals <- -log10(exp_pvals)\n\n#1.g\nplot(log_exp_pvals, log_sort_pvals, col = 'black', xlab = '-log10(expected P-value)', ylab = '-log10(observed P-value)')\nxx <- seq(0, 4, by = 0.01)\nyy <- seq(0, 4, by = 0.01)\nlines(xx, yy, lty = 2, col = 3, lwd = 4)\n\n\n#2.a\nzz <- read.table(\"pheno.sim.2014-1.txt\", header = TRUE)\n\n#2.b\n\nglucose <- zz[, 2]\nthreshold_low <- quantile(glucose, 0.25)\ncontrols <- which(zz[, 2] < threshold_low)\n\n#2.c\nglucose <- zz[, 2]\nthreshold_high <- quantile(glucose, 0.75)\ncases <- which(zz[, 2] > threshold_high)\n\n#2.d\ndd <- density(glucose)\nplot(dd)\nabline(v = threshold_high)\nabline(v = threshold_low)\n\n#2.e\n\ncase_genotypes <- snpsDataFrame[\"rs7584086_T\", cases]\n\n#2.f\ncontrol_genotypes <- snpsDataFrame[\"rs7584086_T\", controls]\n\n#2.g\nsum(case_genotypes == 0)\nsum(case_genotypes == 1)\nsum(case_genotypes == 2)\n\n#2.h\nsum(case_genotypes == 0)\nsum(case_genotypes == 1)\nsum(case_genotypes == 2)\n\n\n\n",
    "created" : 1442966017396.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "995594950",
    "id" : "2EE91D51",
    "lastKnownWriteTime" : 1443042401,
    "path" : "~/GitHub/EEB201-coursework/Plotting Challenges.R",
    "project_path" : "Plotting Challenges.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "type" : "r_source"
}